
defineM(function(f,b,k){function l(c){var d=b.getComponentHTML(c),e=f("<div>"),g=b.getComponent(c);h.params.getActiveWidget().then(function(a){if(!a||!a.id||!a.code||-1==="eb-twitch-feed".search(a.name))throw b.showError("Something went wrong"),Error("Something went wrong");g.safe={id:a.id,code:a.code,account:a.account};e.html(d);e.find(".eb-twitch-feed").html(a.code);b.setComponentHTML(c,e[0].innerHTML)}).finally(function(){e.remove();b.fire("ELBApply");b.render()})}function m(c,d,e){h.params.getIframeUrl().then(function(g){(function(){var a=
void 0,a=e?g+"#/widgets/"+d+"/styles":d?g+"#/widgets/"+d+"/builder":g+"#/widget-creator/twitch-feed",a='<section class="electric-blaze-app" style="position:fixed; height:100%; width:100%">   <iframe class="electric-blaze-app-iframe" src="'+a+'" width="100%" height="100%" align="left"></iframe>   <div style="position: absolute;right: 23px;bottom: 23px;" type="button" title="'+k("Save and Close")+'" data-tooltipster="top" class="btn btn-fab btn-raised btn-primary tooltipstered elb-apply"><i class="mbr-icon-check"></i></div></section>',
a=b.showDialog({className:"modal-fs",body:a,size:"fullscreen"}).find(".electric-blaze-app-iframe")[0];b.addAppResource(b.getAddonDir("eb-twitch-feed")+"/eb-twitch-feed.css");f(".elb-apply").tooltipster({content:f(this).attr("title"),delay:0,speed:100,position:f(this).attr("data-tooltipster")||f(this).attr("data-placement")||"bottom"});f(".elb-apply, .elb-close").click(function(a){l(c._id);f(".modal-fs").remove()})})()})}var n=function(){function c(b,a){a=void 0===a?{}:a;return e().then(function(c){var d=
(a.method||"GET").toUpperCase();if("POST"==d||"PUT"==d)a.contentType="application/json","data"in a&&(a.data=JSON.stringify(a.data));a=Object.assign({credentials:"include",method:d,headers:Object.assign(a.headers||{},{Authorization:"Bearer "+c,"content-type":a.contentType||"application/json"}),body:a.data},a);var e=void 0;return fetch("https://api.electricblaze.com/v1/"+b,a).then(function(a){e=a.status;return a.text()}).then(function(a){a=a?JSON.parse(a):{};if(299<e)throw Object.assign(Error(a.message||
"Invalid server response"),{code:a.code});return a})}).catch(function(a){throw a;})}var d={},e=b.getEventBusToken&&b.getEventBusToken("https://electricblaze.com");return{name:"eb-twitch-feed",getIframeUrl:function(){return Promise.resolve("https://a.electricblaze.com")},getToken:e,getActiveWidget:function(){return Promise.resolve(d)},setActiveWidget:function(b){return Promise.resolve(d=b)},createWidget:function(b){return c("widgets",{method:"POST",data:b})}}}(),h=b.createEventBus&&b.createEventBus(n);
b.regExtension({name:"eb-twitch-feed",events:{loadedComponent:function(c,d,e,f){f||(d=e.find("[data-app-component-id="+c._id+"]").find(".eb-twitch-feed"),d.length&&"eb-twitch-feed"===c.alias&&d.on("click",function(a){a.preventDefault();a.stopPropagation();if("file:"===location.protocol&&0>b.Core.Bridge.versionCmp(b.Core.Bridge.version,"5.6.6"))return b.alertDlg(k("This extension works with app version 5.6.6 and higher. Please update your Mobirise app"));h&&m(c,c.safe&&c.safe.id,c.safe&&c.safe.account)}))},
loaded:function(c){b.createEventBus&&b.createEventBus({name:"electric-blaze-app",getToken:b.getEventBusToken("https://electricblaze.com")})}}})},["jQuery","mbrApp","TR()"]);
